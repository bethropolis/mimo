import "http" as http

show "=== HTTP Error Handling Test ==="

// Test 1: 404 Not Found
show "1. Testing 404 Not Found:"
set bad_url "https://jsonplaceholder.typicode.com/posts/999999999"

call http.get(bad_url) -> response

if = response.status 404
    show "-> Success: Server returned 404 as expected."
else
    show + "-> Unexpected status: " response.status
end

// Test 2: Connection Error (Try/Catch)
show "2. Testing Invalid Domain (Connection Error):"
// This relies on the adapter throwing an error for curl failure (exit code != 0)

try
    call http.get("https://this-domain-does-not-exist.local") -> res
    show "-> Error: Should have failed but got a response."
catch err
    show "-> Success: Caught connection error."
    // The error message comes from your adapter's spawnSync check
    show + "   Message: " err.message
end

show "=== Error Test Complete ==="
